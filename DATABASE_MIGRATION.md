# Инструкция по миграции и изменению БД

## Порядок работы с миграциями Drizzle

### 1. Изменение схемы базы данных

При необходимости обновления БД изменяйте **только** файл схемы:

```
shared/schema.ts
```

В этом файле описываются все таблицы и их структура с помощью Drizzle ORM.

### 2. Генерация миграций

Перед коммитом изменений **обязательно** выполните команду:

```bash
npx drizzle-kit generate
```

Эта команда автоматически создаст SQL-миграцию на основе изменений в схеме.

### 3. Папка миграций

**НЕ ТРОГАЙТЕ** папку `migrations/` вручную:

- Не редактируйте файлы миграций
- Не удаляйте миграции
- Не меняйте порядок миграций

Drizzle самостоятельно управляет этой папкой и применяет миграции к базе данных.

## Краткий чеклист

- [ ] Изменить `shared/schema.ts`
- [ ] Выполнить `npx drizzle-kit generate`
- [ ] Проверить созданную миграцию в `migrations/`
- [ ] Закоммитить изменения (схема + сгенерированная миграция)

## Примечания

- Старые миграции хранятся в папке `old_migrations/` для справки
- Drizzle автоматически применяет новые миграции при запуске приложения
